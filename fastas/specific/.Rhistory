ggplot() + geom_line(aes(vec1,conservation_CPS_I))
ggplot() + geom_line(aes(vec1,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 100000, ymin = 0, ymax = 1000, alpha = .2, color = 'red')
ggplot() + geom_line(aes(vec1,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 10000, alpha = .2, color = 'red')
ggplot() + geom_line(aes(vec1,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 10000, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vec1,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
###APES###
library(ape)
d_CPSI <- dist.alignment(I_aligned, "identity")
d_CPSII <- dist.alignment(II_aligned, "identity")
library('seqinr')
seq_I_aligned <- msaConvert(I_aligned, type="seqinr::alignment")
seq_II_aligned <- msaConvert(II_aligned, type="seqinr::alignment")
seq_III_aligned <- msaConvert(III_aligned, type="seqinr::alignment")
seq_I_II_aligned <- msaConvert(I_II_aligned, type="seqinr::alignment")
seq_I_III_aligned <- msaConvert(I_III_aligned, type="seqinr::alignment")
seq_II_III_aligned <- msaConvert(II_III_aligned, type="seqinr::alignment")
seq_I_II_III_aligned <- msaConvert(I_II_III_aligned, type="seqinr::alignment")
d_CPSI <- dist.alignment(seq_I_aligned, "identity")
d_CPSII <- dist.alignment(seq_II_aligned, "identity")
d_CPSIII <- dist.alignment(seq_III_aligned, "identity")
d_CPS_I_II <- dist.alignment(seq_I_II_aligned, "identity")
d_CPS_I_III <- dist.alignment(seq_I_III_aligned, "identity")
d_CPS_II_III <- dist.alignment(seq_II_III_aligned, "identity")
d_CPS_I_II_III <- dist.alignment(seq_I_II_III_aligned, "identity")
t_CPSI <- nj(d_CPS_I)
t_CPSI <- nj(d_CPSI)
t_CPSII <- nj(d_CPSII)
t_CPSIII <- nj(d_CPSIII)
t_CPS_I_II <- nj(d_CPS_I_II)
t_CPS_I_III <- nj(d_CPS_I_III)
t_CPS_II_III <- nj(d_CPS_II_III)
t_CPS_I_II_III <- nj(d_CPS_I_II_III)
write.tree(t_CPSI, file = "t_CPSI", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPSI, file = "t_CPSI.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPSII, file = "t_CPSII.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPSIII, file = "t_CPSIII.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPS_I_II, file = "t_CPS_I_II.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPS_I_III, file = "t_CPS_I_III.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPS_II_III, file = "t_CPS_II_III.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
write.tree(t_CPS_I_II_III, file = "t_CPS_I_II_III.nwk", append = FALSE,
digits = 10, tree.names = TRUE)
ggplot() + geom_line(aes(vec1,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
vecI <- vector()
vecI <- c(vec1, 1:length(conservation_CPS_I))
vecII <- vector()
vecII <- c(vec1, 1:length(conservation_CPS_II))
vecIII <- vector()
vecIII <- c(vec1, 1:length(conservation_CPS_III))
vecI_II <- vector()
vecI_II <- c(vec1, 1:length(conservation_CPS_I_II))
vecI_III <- vector()
vecI_III <- c(vec1, 1:length(conservation_CPS_I_III))
vecII_III <- vector()
vecII_III <- c(vec1, 1:length(conservation_CPS_II_III))
vecI_II_III <- vector()
vecI_II_III <- c(vec1, 1:length(conservation_CPS_I_II_III))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
conservation_CPS_I = msa::msaConservationScore(I_aligned, BLOSUM62)
conservation_CPS_II = msa::msaConservationScore(II_aligned, BLOSUM62)
conservation_CPS_III = msa::msaConservationScore(III_aligned, BLOSUM62)
conservation_CPS_I_II = msa::msaConservationScore(I_II_aligned, BLOSUM62)
conservation_CPS_I_III = msa::msaConservationScore(I_III_aligned, BLOSUM62)
conservation_CPS_II_III = msa::msaConservationScore(II_III_aligned, BLOSUM62)
conservation_CPS_I_II_III = msa::msaConservationScore(I_II_III_aligned, BLOSUM62)
vecI <- vector()
vecI <- c(vecI, 0:length(conservation_CPS_I))
vecII <- vector()
vecII <- c(vecII, 1:length(conservation_CPS_II))
vecIII <- vector()
vecIII <- c(vecIII, 1:length(conservation_CPS_III))
vecI_II <- vector()
vecI_II <- c(vecI_II, 1:length(conservation_CPS_I_II))
vecI_III <- vector()
vecI_III <- c(vecI_III, 1:length(conservation_CPS_I_III))
vecII_III <- vector()
vecII_III <- c(vecII_III, 1:length(conservation_CPS_II_III))
vecI_II_III <- vector()
vecI_II_III <- c(vecI_II_III, 1:length(conservation_CPS_I_II_III))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
vecI <- c(vecI, 1:length(conservation_CPS_I))
vecI <- vector()
vecI <- c(vecI, 1:length(conservation_CPS_I))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
vecI <- vector()
vecI <- c(vecI, 0:length(conservation_CPS_I))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
vecI <- c(vecI, 1:length(conservation_CPS_I))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
vecI <- vector()
vecI <- c(vecI, 1:length(conservation_CPS_I))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100000, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100000, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 0, xmax = 500, ymin = 0, ymax = 100, alpha = .2, fill = 'red') + annotate("rect", xmin = 550, xmax = 1050, ymin = 0, ymax = 100, alpha = .2, fill = 'green')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 0, xmax = length(conservation_CPS_I), ymin = 0, ymax = pmax(conservation_CPS_I), alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = pmax(conservation_CPS_I), alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = pmax(conservation_CPS_I), alpha = .1, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = 1000, alpha = .1, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = 10000, alpha = .1, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = 100000, alpha = .1, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'milk')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1488, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1488, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = 0, ymax = max(conservation_CPS_I)*0.7, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1488, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.7, ymax = max(conservation_CPS_I)*0.7, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1488, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.7, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1488, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red') + + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .1, fill = 'purple')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = 1, fill = 'purple')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple')
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'gray')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'hotpink4')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'hotpink4') + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orchid') + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I), alpha = .4, fill = 'orchid') + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue')
ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue')
ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
grid.arrange(
grobs = gl,
widths = c(2, 1, 1),
layout_matrix = rbind(c(1, 2, NA),
c(3, 3, 4))
)
library(gridextra)
library(egg)
library(gridExtra)
install.packages(gridExtra)
install.packages("gridExtra")
library(gridExtra)
grid.arrange(
grobs = gl,
widths = c(2, 1, 1),
layout_matrix = rbind(c(1, 2, NA),
c(3, 3, 4))
)
grid.arrange(
widths = c(3, 3, 3),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
)
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
grid.arrange(
widths = c(3, 3, 3),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
)
grid.arrange(
widths = c(1, 1, 1),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
)
ggplot_build()
ggplot_build(grid.arrange(
widths = c(1, 1, 1),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
))
ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
grid.arrange(
widths = c(1, 1, 1),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
)
ggarrange(p1,p2,p3,p4,p5,p6,p7,p7,p7)
grid.arrange(
widths = c(1, 1, 1),
layout_matrix = rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
)
library(grid)
library(lattice)
grid.arrange(p1, p2, p3, p4, p5, p6, p7, ncol=3)
p1 <- ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p2 <- ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p3 <- ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
p4 <- ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p5 <- ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p6 <- ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p7 <- ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
grid.arrange(p1, p2, p3, p4, p5, p6, p7, ncol=3)
lay <- rbind(c(1,2,3),
c(4,5,6),
c(7,7,7))
grid.arrange(layout_matrix = lay)
p1 <- ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p2 <- ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p3 <- ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
p4 <- ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p5 <- ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p6 <- ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p7 <- ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
lay <- rbind(c(1,2,3),
c(4,5,6),
c(7,7,7))
grid.arrange(layout_matrix = lay)
grid.arrange(grobs = '', layout_matrix = lay)
gs <- lapply(1:9, function(ii)
grobTree(rectGrob(gp=gpar(fill=ii, alpha=0.5)), textGrob(ii)))
lay <- rbind(c(1,2,3),
c(4,5,6),
c(7,7,7))
grid.arrange(grobs = gs, layout_matrix = lay)
lay <- rbind(c(1,1,1,2,3),
c(1,1,1,4,5),
c(6,7,8,9,9))
grid.arrange(grobs = gs, layout_matrix = lay)
p1 <- ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p2 <- ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p3 <- ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
p4 <- ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p5 <- ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p6 <- ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p7 <- ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
lay <- rbind(c(1,1,1,2,3),
c(1,1,1,4,5),
c(6,7,8,9,9))
grid.arrange(grobs = gs, layout_matrix = lay)
grid.arrange(layout_matrix = lay)
lay <- rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
grobs = c(p1, p2, p3, p4, p5, p6, p7)
grid.arrange(layout_matrix = lay)
grid.arrange(grobs = grobs, layout_matrix = lay)
lay <- rbind(c(1, 2, 3),
c(4, 5, 6),
c(7, 7, 7))
gs = c(p1, p2, p3, p4, p5, p6, p7)
grid.arrange(grobs = gs, layout_matrix = lay)
gs <- c(p1, p2, p3, p4, p5, p6, p7)
grid.arrange(grobs = gs, layout_matrix = lay)
grid.arrange(grobs = c(p1,p2,p3,p4,p5,p6,p7), layout_matrix = lay)
p1 <- as.grob(p1)
library("ggplotify")
install.packages("ggplotify")
library("ggplotify")
p1 <- as.grob(p1)
gs <- c(p1, p2, p3, p4, p5, p6, p7)
grid.arrange(grobs = c(p1,p2,p3,p4,p5,p6,p7), layout_matrix = lay)
p1 <- ggplot() + geom_line(aes(vecI,conservation_CPS_I)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p2 <- ggplot() + geom_line(aes(vecII,conservation_CPS_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p3 <- ggplot() + geom_line(aes(vecIII,conservation_CPS_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
p4 <- ggplot() + geom_line(aes(vecI_II,conservation_CPS_I_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p5 <- ggplot() + geom_line(aes(vecI_III,conservation_CPS_I_III)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_I) - max(conservation_CPS_I)*0.9, ymax = max(conservation_CPS_I)*0.9, alpha = .2, fill = 'cyan')
p6 <- ggplot() + geom_line(aes(vecII_III,conservation_CPS_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_II) - max(conservation_CPS_II)*0.9, ymax = max(conservation_CPS_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p7 <- ggplot() + geom_line(aes(vecI_II_III,conservation_CPS_I_II_III)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_CPS_I_II) - max(conservation_CPS_I_II)*0.9, ymax = max(conservation_CPS_I_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_CPS_I_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
plot_grid(p1, p2, p3, p4, p5, p6, p7, p7, p7, ncol=3)
library(cowplot)
install.packages(cowplot)
install.packages("cowplot")
install.packages("cowplot")
grid.arrange(p1,p2,p3,p4,p5,p6,p7,p7,p7, ncol=3)
grid.arrange(p1,p2,p3,p4,p5,p6,p7,p7,p7, layout_matrix = rbind(c(1,2,3),c(4,5,6), c(7,7,7)))
grid.arrange(p1,p2,p3,p4,p5,p6,p7,p7,p7, layout_matrix = rbind(c(1,2,3),c(4,5,6), c(7,8,9)))
grid.arrange(p1,p2,p3,p4,p5,p6,p7,p7,p7, layout_matrix = rbind(c(1,2,3),c(4,5,6), c(7)))
grid.arrange(grobs = list(p1, p2, p3, p4, p5, p6, p7),
layout_matrix = lay)
writeXStringSet(I_consensus, filepath = "I_consensus.fas")
writeXStringSet(unmasked(I_consensus), filepath = "I_consensus.fas")
write.fasta(I_consensus, file.out = "I_cons.fas")
cat(I_consensus, file="conses.fas",append=TRUE)
cat(">CPSI_consensus", file="conses.fas",append=TRUE))
cat(">CPSI_consensus\n", file="conses.fas",append=TRUE)
cat(I_consensus, file="conses.fas",append=TRUE)
cat(">CPSII_consensus\n", file="conses.fas",append=TRUE)
cat(II_consensus, file="conses.fas",append=TRUE)
cat(">CPSIII_consensus\n", file="conses.fas",append=TRUE)
cat(III_consensus, file="conses.fas",append=TRUE)
cat(">CPSI_consensus\n", file="conses.fas",append=TRUE)
cat(I_consensus, file="conses.fas",append=TRUE)
cat("\n", file="conses.fas",append=TRUE)
cat(">CPSII_consensus\n", file="conses.fas",append=TRUE)
cat(II_consensus, file="conses.fas",append=TRUE)
cat("\n", file="conses.fas",append=TRUE)
cat(">CPSIII_consensus\n", file="conses.fas",append=TRUE)
cat(III_consensus, file="conses.fas",append=TRUE)
cat("\n", file="conses.fas",append=TRUE)
consensus <- readAAStringSet("conses.fas")
cons_aligned <- msa(consensus)
conservation_consensus = msa::msaConservationScore(cons_aligned, BLOSUM62)
vec_cons <- vector()
vec_cons <- c(vec_cons, 1:length(conservation_consensus))
p8 <- ggplot() + geom_line(aes(vec_cons, conservation_consensus)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
View(p8)
grid.arrange(grobs = list(p1, p2, p3, p4, p5, p6, p7, p8),
layout_matrix = lay)
p8 <- ggplot() + geom_line(aes(vec_cons, conservation_consensus)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_CPS_III), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_CPS_III) - max(conservation_CPS_III)*0.9, ymax = max(conservation_CPS_III)*0.9, alpha = .2, fill = 'cyan')
lay <- rbind(c(1,2,3),
c(4,5,6),
c(7,7,7),
c(8,8,8))
grid.arrange(grobs = list(p1, p2, p3, p4, p5, p6, p7, p8),
layout_matrix = lay)
p8 <- ggplot() + geom_line(aes(vec_cons, conservation_consensus)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_consensus), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_consensus), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_consensus) - max(conservation_consensus)*0.9, ymax = max(conservation_consensus)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_consensus) - max(conservation_consensus)*0.9, ymax = max(conservation_consensus)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_consensus), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_consensus), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_consensus), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
lay <- rbind(c(1,2,3),
c(4,5,6),
c(7,7,7),
c(8,8,8))
grid.arrange(grobs = list(p1, p2, p3, p4, p5, p6, p7, p8),
layout_matrix = lay)
library(msa)
setwd("/home/fatih/Documents/ENS210/project/fastas/specific")
amph_1 <- readAAStringSet("CPS1_amphibians.fas")
fish_1 <- readAAStringSet("CPS1_fishes.fas")
fish_1 <- readAAStringSet("CPS1_fishes.fas")
ter_1 <- readAAStringSet("CPS1_birds&mammals.fas")
amph_2 <- readAAStringSet("CPS2_amphibians.fas")
fish_2 <- readAAStringSet("CPS2_fishes.fas")
ter_2 <- readAAStringSet("CPS2_terrastrial.fas")
amph_1_a <- msa(amph_1)
fish_1_a <- msa(fish_1)
ter_1_a <- msa(ter_1)
amph_2_a <- msa(amph_2)
fish_2_a <- msa(fish_2)
ter_2_a <- msa(ter_2)
writeXStringSet(unmasked(amph_1_a), filepath = "amph_1_a.fas")
writeXStringSet(unmasked(fish_1_a), filepath = "fish_1_a.fas")
writeXStringSet(unmasked(ter_1_a), filepath = "ter_1_a.fas")
writeXStringSet(unmasked(amph_2_a), filepath = "amph_2_a.fas")
writeXStringSet(unmasked(fish_2_a), filepath = "fish_2_a.fas")
writeXStringSet(unmasked(ter_2_a), filepath = "ter_2_a.fas")
amph_1_c <- readAAStringSet("amph_1_a_c.fas")
fish_1_c <- readAAStringSet("fish_1_a_c.fas")
ter_1_c <- readAAStringSet("ter_1_a_c.fas")
amph_2_c <- readAAStringSet("amph_2_a_c.fas")
fish_2_c <- readAAStringSet("fish_2_a_c.fas")
ter_2_c <- readAAStringSet("ter_2_a_c.fas")
amph_1_a_c <- msa(amph_1_c)
fish_1_a_c <- msa(fish_1_c)
ter_1_a_c <- msa(ter_1_c)
amph_2_a_c <- msa(amph_2_c)
fish_2_a_c <- msa(fish_2_c)
ter_2_a_c <- msa(ter_2_c)
data(BLOSUM62)
conservation_fish_1 = msa::msaConservationScore(fish_1_a_c, BLOSUM62)
conservation_amph_1 = msa::msaConservationScore(amph_1_a_c, BLOSUM62)
conservation_ter_1 = msa::msaConservationScore(ter_1_a_c, BLOSUM62)
conservation_fish_2 = msa::msaConservationScore(fish_2_a_c, BLOSUM62)
conservation_amph_2 = msa::msaConservationScore(amph_2_a_c, BLOSUM62)
conservation_ter_2 = msa::msaConservationScore(ter_2_a_c, BLOSUM62)
p1 <- ggplot() + geom_line(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
pos1 <- vector()
pos1 <- c(pos1, 1:length(conservation_fish_1))
pos2 <- vector()
pos2 <- c(pos2, 1:length(conservation_amph_1))
pos3 <- vector()
pos3 <- c(pos3, 1:length(conservation_ter_1))
pos4 <- vector()
pos4 <- c(pos4, 1:length(conservation_fish_2))
pos5 <- vector()
pos5 <- c(pos5, 1:length(conservation_amph_2))
pos6 <- vector()
pos6 <- c(pos6, 1:length(conservation_ter_2))
p1 <- ggplot() + geom_line(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p2 <- ggplot() + geom_line(aes(pos1,conservation_amph_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p2
p2 <- ggplot() + geom_line(aes(pos2,conservation_amph_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p2
p2 <- ggplot() + geom_line(aes(pos2,conservation_amph_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_amph_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_amph_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_amph_1) - max(conservation_amph_1)*0.9, ymax = max(conservation_amph_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_amph_1) - max(conservation_amph_1)*0.9, ymax = max(conservation_amph_1)*0.9, alpha = .2, fill = 'cyan')
p2
p1
p2
p3 <- ggplot() + geom_line(aes(pos2,conservation_ter_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_ter_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_ter_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_ter_1) - max(conservation_ter_1)*0.9, ymax = max(conservation_ter_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_ter_1) - max(conservation_ter_1)*0.9, ymax = max(conservation_ter_1)*0.9, alpha = .2, fill = 'cyan')
p3
p3 <- ggplot() + geom_line(aes(pos3,conservation_ter_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_ter_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_ter_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_ter_1) - max(conservation_ter_1)*0.9, ymax = max(conservation_ter_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_ter_1) - max(conservation_ter_1)*0.9, ymax = max(conservation_ter_1)*0.9, alpha = .2, fill = 'cyan')
p3
p4 <- ggplot() + geom_line(aes(pos4,conservation_fish_II)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_fish_II), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_fish_II), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_fish_II) - max(conservation_fish_II)*0.9, ymax = max(conservation_fish_II)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_fish_II) - max(conservation_fish_II)*0.9, ymax = max(conservation_fish_II)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_fish_II), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_fish_II), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_fish_II), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p4 <- ggplot() + geom_line(aes(pos4,conservation_fish_2)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_fish_2), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_fish_2), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_fish_2) - max(conservation_fish_2)*0.9, ymax = max(conservation_fish_2)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_fish_2) - max(conservation_fish_2)*0.9, ymax = max(conservation_fish_2)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_fish_2), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_fish_2), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_fish_2), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p4
p5 <- ggplot() + geom_line(aes(pos5,conservation_amph_2)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_amph_2), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_amph_2), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_amph_2) - max(conservation_amph_2)*0.9, ymax = max(conservation_amph_2)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_amph_2) - max(conservation_amph_2)*0.9, ymax = max(conservation_amph_2)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_amph_2), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_amph_2), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_amph_2), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p5
p6 <- ggplot() + geom_line(aes(pos6,conservation_ter_2)) + annotate("rect", xmin = 1, xmax = 355, ymin = 0, ymax = max(conservation_ter_2), alpha = .2, fill = 'blue') + annotate("rect", xmin = 391, xmax = 1440, ymin = 0, ymax = max(conservation_ter_2), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1313, xmax = 1438, ymin = max(conservation_ter_2) - max(conservation_ter_2)*0.9, ymax = max(conservation_ter_2)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 799, xmax = 921, ymin = max(conservation_ter_2) - max(conservation_ter_2)*0.9, ymax = max(conservation_ter_2)*0.9, alpha = .2, fill = 'cyan') + annotate("rect", xmin = 1460, xmax = 1806, ymin = 0, ymax = max(conservation_ter_2), alpha = .2, fill = 'purple') + annotate("rect", xmin = 1812, xmax = 1907, ymin = 0, ymax = max(conservation_ter_2), alpha = .2, fill = 'yellow1') + annotate("rect", xmin = 1925, xmax = 2065, ymin = 0, ymax = max(conservation_ter_2), alpha = .4, fill = 'orchid')# + annotate("rect", xmin = 1920, xmax = 2224, ymin = 0, ymax = max(conservation_CPS_I), alpha = .2, fill = 'green1')
p6
lay <- rbind(c(1,1,1),
c(2,2,2),
c(3,3,3),
c(4,4,4),
c(5,5,5),
c(6,6,6))
grid.arrange(grobs = list(p1, p2, p3, p4, p5, p6),
layout_matrix = lay)
p1 <- ggplot() + geom_line(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
library(msa)
setwd("/home/fatih/Documents/ENS210/project/fastas/specific")
amph_1 <- readAAStringSet("CPS1_amphibians.fas")
fish_1 <- readAAStringSet("CPS1_fishes.fas")
ter_1 <- readAAStringSet("CPS1_birds&mammals.fas")
amph_2 <- readAAStringSet("CPS2_amphibians.fas")
fish_2 <- readAAStringSet("CPS2_fishes.fas")
ter_2 <- readAAStringSet("CPS2_terrastrial.fas")
amph_1_a <- msa(amph_1)
fish_1_a <- msa(fish_1)
ter_1_a <- msa(ter_1)
amph_2_a <- msa(amph_2)
fish_2_a <- msa(fish_2)
ter_2_a <- msa(ter_2)
writeXStringSet(unmasked(amph_1_a), filepath = "amph_1_a.fas")
writeXStringSet(unmasked(fish_1_a), filepath = "fish_1_a.fas")
writeXStringSet(unmasked(ter_1_a), filepath = "ter_1_a.fas")
writeXStringSet(unmasked(amph_2_a), filepath = "amph_2_a.fas")
writeXStringSet(unmasked(fish_2_a), filepath = "fish_2_a.fas")
writeXStringSet(unmasked(ter_2_a), filepath = "ter_2_a.fas")
amph_1_c <- readAAStringSet("amph_1_a_c.fas")
fish_1_c <- readAAStringSet("fish_1_a_c.fas")
ter_1_c <- readAAStringSet("ter_1_a_c.fas")
amph_2_c <- readAAStringSet("amph_2_a_c.fas")
fish_2_c <- readAAStringSet("fish_2_a_c.fas")
ter_2_c <- readAAStringSet("ter_2_a_c.fas")
amph_1_a_c <- msa(amph_1_c)
fish_1_a_c <- msa(fish_1_c)
ter_1_a_c <- msa(ter_1_c)
amph_2_a_c <- msa(amph_2_c)
fish_2_a_c <- msa(fish_2_c)
ter_2_a_c <- msa(ter_2_c)
data(BLOSUM62)
conservation_fish_1 = msa::msaConservationScore(fish_1_a_c, BLOSUM62)
conservation_amph_1 = msa::msaConservationScore(amph_1_a_c, BLOSUM62)
conservation_ter_1 = msa::msaConservationScore(ter_1_a_c, BLOSUM62)
conservation_fish_2 = msa::msaConservationScore(fish_2_a_c, BLOSUM62)
conservation_amph_2 = msa::msaConservationScore(amph_2_a_c, BLOSUM62)
conservation_ter_2 = msa::msaConservationScore(ter_2_a_c, BLOSUM62)
pos1 <- vector()
pos1 <- c(pos1, 1:length(conservation_fish_1))
pos2 <- vector()
pos2 <- c(pos2, 1:length(conservation_amph_1))
pos3 <- vector()
pos3 <- c(pos3, 1:length(conservation_ter_1))
pos4 <- vector()
pos4 <- c(pos4, 1:length(conservation_fish_2))
pos5 <- vector()
pos5 <- c(pos5, 1:length(conservation_amph_2))
pos6 <- vector()
pos6 <- c(pos6, 1:length(conservation_ter_2))
p1 <- ggplot() + geom_scatter(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_scatter(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
library(ggplot2)
p1 <- ggplot() + geom_scatter(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1 <- ggplot() + geom_dotplot(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_hline(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_smooth(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_bar(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_bar(aes(conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_linerange(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_point(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_qq(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_rug(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
p1 <- ggplot() + geom_step(aes(pos1,conservation_fish_1)) + annotate("rect", xmin = 55, xmax = 409, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'blue') + annotate("rect", xmin = 430, xmax = 1502, ymin = 0, ymax = max(conservation_fish_1), alpha = .2, fill = 'orange') + annotate("rect", xmin = 1371, xmax = 1486, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'red')  + annotate("rect", xmin = 850, xmax = 973, ymin = max(conservation_fish_1) - max(conservation_fish_1)*0.9, ymax = max(conservation_fish_1)*0.9, alpha = .2, fill = 'cyan')
p1
